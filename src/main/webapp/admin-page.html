<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>관리자 페이지</title>	

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  	
  	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="./slick/slick.css"/>
	<link rel="stylesheet" type="text/css" href="./slick/slick-theme.css"/>
	<link rel="stylesheet" type="text/css" href="./css/admin-page/admin-page.css" />
	
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<style>
	@font-face {
	    font-family: 'Pretendard-Regular';
	    src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
	    font-weight: 400;
	    font-style: normal;
	}
	
	.section-container {
	    font-family: 'Pretendard-Regular', sans-serif;
	}
</style>
</head>
<body>
	<!-- Header -->
	<div id="header-container"></div>
	<!-- section -->
	<div id="section" class="section-container">
	
		<!-- 관리자 정보 -->
		<div id="info" class="section-component">
			<h5>관리자 정보</h5>
			<form>
				<div class="info-component">
					<div class="info-group">
						<label for="nick">닉네임</label>
						<input type="text" name="nick" id="nick" value="서울게하주인" />				
					</div>
					<div class="info-group">
						이름
						<input type="text" name="name" id="name" value="김주인" />
					</div>
					<div  class="info-group">
						<label>전화번호</label>
						<input type="text" name="number" id="number" value="010-1234-5678" />
					</div>
					<div  class="info-group">
						<label>생년월일</label>
						<input type="date" name="birthday" id="birthday" value="1999-01-01" />
					</div>
					<div  class="info-group">
						<label>성별</label>
						<input type="password" name="gender" id="gender" value="남성" />
					</div>
					<button id="btn-info" class="btn btn-danger">저장</button> 
				</div>
				
			</form>
		</div>
		
		<!-- 게스트하우스 관리하기 -->
		<div id="management" class="discount">
			<div class="section-component">
				<div class="component-header">
					<h5>내 게스트하우스 관리하기</h5>
				</div>	
				<div class="management-contanier">
					<div class="management-gh">
						<img src="./img/mypage/img01-01.png"/>
						<h5>별자리 여관</h5>
						<p>서울특별시 마포구 새별로 123</p>
						<div>
							<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#ghManagementModal">관리</button>
						</div>
					</div>
					<div class="management-gh">
						<img src="./img/mypage/img02-01.png"/>
						<h5>어떤하루</h5>
						<p>강원도 춘천시 소양강로 321</p>
						<div>
							<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#ghManagementModal">관리</button>
						</div>
					</div>
					<div class="management-gh">
						<img src="./img/mypage/img03-01.png"/>
						<h5>어울림하우스</h5>
						<p>대전광역시 유성구 과학로 89</p>
						<div>
							<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#ghManagementModal">관리</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- 매출 요약 -->
		<div id="income">	
			<div class="income-container">				
				<div class="income-item">
					<div class="income-component">
						<div>오늘 입실할 고객 수</div>
						<div>10명</div>
					</div>
					<div  class="income-component">
						<div>현재 숙박 중인 고객 수</div>
						<div>24명</div>
					</div>
					<div  class="income-component">
						<div>오늘 퇴실할 고객 수</div>
						<div>8명</div>
					</div>
					<div  class="income-component">
						<div>현재 사용 중인 방</div>
						<div>5개</div>
					</div>
				</div>
				<div class="income-item">
					<div style="display: flex; justify-content: space-between; align-items: center;">
						<h5>신규 예약 목록</h5>
					</div>
					<div class="income-component">
						<div>어울림하우스</div>
						<div>601호실</div>
						<div>5명</div>
						<div>체크인: 2025-06-26</div>
					</div>
					<div class="income-component">
						<div>별자리 여관</div>
						<div>102호실</div>
						<div>2명</div>
						<div>체크인: 2025-06-22</div>
					</div>
					<div  class="income-component">
						<div>어떤하루</div>
						<div>203호실</div>
						<div>4명</div>
						<div>체크인: 2025-07-05</div>
					</div>
				</div>
				<div class="income-item">
					<div id="income-today">
						<div style="font-weight: bold">오늘 정산</div>
						<div style="display: flex; justify-content: space-between;">
							<div style="color: #808080">정산금액</div>
							<div style="font-weight: bold">320,500원</div>
						</div>
					</div>
					<div id="income-expect">
						<div style="font-weight: bold">정산 예정</div>
						<div style="display: flex; justify-content: space-between;">
							<div style="color: #808080">정산금액</div>
							<div style="font-weight: bold">5,828,200원</div>
						</div>
					</div>
					<div class="income-component" >
						<div>06.23 예정</div>
						<div>5,828,200원</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- 차트 분석 -->
		<div id="chart">
			<div class="chart-contanier">
				<div class="chart-row">
					<div class="chart-item">
						<h5>2025년 월 별 매출</h5>
						<div class="chart" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
							<canvas id="income-2025" width="400" height="400"></canvas>
						</div>
					</div>					
					<div class="chart-item">
						<h5>인기 게스트하우스</h5>
						<div class="chart" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
							<canvas id="gh-popular" width="350" height="350"></canvas>
						</div>
					</div>
				</div>
				<div class="chart-row">
					<div class="chart-item">
						<h5>2024년 월 별 매출</h5>
						<div class="chart" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
							<canvas id="income-2024" width="400" height="400"></canvas>
						</div>
					</div>
					<div class="chart-item">
						<h5>전년 대비</h5>
						<div class="chart" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
							<canvas id="diff-income" width="400" height="400"></canvas>
						</div>
					</div>
				</div>
			</div>			
		</div>
		
	</div>	
	
	<!-- modal -->
	<div id="managnent-modal">
		
	</div>
	
	<!-- footer -->
	<div id="footer-container" class="footer">
	
	</div>
	
	<!-- 헤더 관련 코드 -->
	<script>
	$(() => {
		$("#header-container").load("./header/header.html", function () {
			const username = localStorage.getItem("loggedInUser");
		    if (username) {
		    	$(".username").text(`${username}님`);
		    }
		});
		
		
  	});
	</script>
	
	<script>
	$(() => {
		const nickForm = document.querySelector('#nick');
		const nameForm = document.querySelector('#name');
		const phoneForm = document.querySelector('#number');
		const birthForm = document.querySelector('#birthday');
		const genderForm = document.querySelector('#gender');
		
  	 	// 사용자 정보 불러오기
  	 	const username = localStorage.getItem("loggedInUser") || '';
  	 	const adminInfo = JSON.parse(localStorage.getItem("adminInfo")) || {};
  	 	
  	 	if (!adminInfo.hasOwnProperty(username)) {
  	 		alert("등록되지 않은 사용자입니다!!!");
  	 		console.warn(`사용자 정보가 없습니다: '${username}'`);  	 		
  		  	location.href = "./index.html";
  		} else {
  			const user = adminInfo[username];

    		nickForm.value = username;
    		nameForm.value = user.name;
    		phoneForm.value = user.phone;
    		birthForm.value = user.birthDay;
    		genderForm.value = user.gender;
  		}
  	 	
		const btnInfo = document.querySelector('#btn-info');
		
		btnInfo.addEventListener('click', () => {
			console.log("Press Button");
			
			// 1. 현재 userInfo를 가져와서
			let userInfo = JSON.parse(localStorage.getItem("userInfo")) || {}; // 없을 경우 빈 객체

			// 현재 입력된 닉네임(사용자명)
			const username = nickForm.value;

			// 2. 닉네임을 가지고 있는지 확인하고
			if (adminInfo.hasOwnProperty(username)) {
			  // 3-1. 있다면 해당 정보 수정
			  adminInfo[username].name = nameForm.value;
			  adminInfo[username].phone = phoneForm.value;
			  adminInfo[username].birthDay = birthForm.value;
			  adminInfo[username].gender = genderForm.value;
			}
			
			if (confirm("관리자 정보를 수정하시겠습니까?")) {
				// 변경된 정보 localStorage에 저장
				localStorage.setItem("adminInfo", JSON.stringify(adminInfo));
				alert("관리자 정보가 수정되었습니다.");
			} else {
				return;
			}
		});
	});
	</script>
	
	<!-- 모달 관련 코드 -->
	<script>
	$(document).ready(function() {
        $("#managnent-modal").load("./html/admin-page/gh-management-modal.html");
    });
	</script>
	
	<!-- chart 코드 -->
	<script>
	$(() => {
		const ctxIncome2024 = document.querySelector("#income-2024");
		const ctxGhPopluar = document.querySelector("#gh-popular");
		const ctxIncome2025 = document.querySelector("#income-2025");
		const ctxDiffIncome = document.querySelector("#diff-income");
		
		let month = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월' ,'11월', '12월'];
		
		// Data
		let data_2025 = {
				label:'2025년 게스트하우스 매출',
				data:[100,98,67,57,67,140],
				backgroundColor:'rgba(103,106,245, .4)',
		};		
		let data_2024 = {
				label:'2024년 게스트하우스 매출',
				data:[90,97,77,60,67, 130, 150, 100,90,90, 100, 110],
				backgroundColor:'rgba(100, 255, 100, .4)',
		};
		let ghPopular = {
				label:'게스트하우스 예약 수',
				data:[23, 53, 12],
				hoverOffset: 6,
		}
		let ghDiffIncome = {
				label:'작년 대비 매출차이',
				data: [100 - 90,98 - 97,67 - 77,57 - 60,67 - 67,140 - 130],
		}
		
		// Config
		let config_2025 = {
			type: 'bar',
			data: {
				labels: ['1월', '2월', '3월', '4월', '5월', '6월'],
				datasets: [data_2025],
			},
			options: {
				maintainAspectRatio: false,
				scales: {
					
				},
				responsive: false,
			}
		}	
		
		let config_2024 = {
				type: 'bar',
				data: {
					labels: month,
					datasets: [data_2024],
				},
				options: {
					maintainAspectRatio: false,
					scales: {
						
					},
					responsive: false,
				}
			}	
		
		let config_popular = {
				type: 'pie',
				data: {
					labels: ["별자리 여관", "어떤하루", "어울림하우스"],
					datasets: [ghPopular],
				},
				options: {
					responsive: false,
				},
			}	
		
		let config_diff = {
				type: 'line',
				data: {
					labels: ['1월', '2월', '3월', '4월', '5월', '6월'],
					datasets: [ghDiffIncome],
				},
				options: {
					responsive: false,
				},
			}	
		new Chart(ctxIncome2024, config_2024);
		new Chart(ctxGhPopluar, config_popular);
		new Chart(ctxIncome2025, config_2025);
		new Chart(ctxDiffIncome, config_diff);
	});
	
	
	</script>
	<script type="text/javascript">
	$("#footer-container").load("./footer/footer.html");
	</script>
</body>

</html>